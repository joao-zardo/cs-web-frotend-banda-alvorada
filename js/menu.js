document.addEventListener('DOMContentLoaded',()=>{const hamburgerBtn=document.querySelector('.hamburger-menu');const navLinksContainer=document.querySelector('#nav-links');if(!hamburgerBtn||!navLinksContainer)return;const focusableItemsMobile=navLinksContainer.querySelectorAll('a[href]:not([disabled]), button:not([disabled])');const firstFocusableItemMobile=focusableItemsMobile[0];const lastFocusableItemMobile=focusableItemsMobile[focusableItemsMobile.length-1];function openMenu(){navLinksContainer.classList.add('is-active');hamburgerBtn.classList.add('is-active');hamburgerBtn.setAttribute('aria-expanded','true');hamburgerBtn.setAttribute('aria-label','Fechar menu');firstFocusableItemMobile.focus()}
function closeMenu(){navLinksContainer.classList.remove('is-active');hamburgerBtn.classList.remove('is-active');hamburgerBtn.setAttribute('aria-expanded','false');hamburgerBtn.setAttribute('aria-label','Abrir menu');hamburgerBtn.focus()}
hamburgerBtn.addEventListener('click',()=>{const isMenuOpen=navLinksContainer.classList.contains('is-active');isMenuOpen?closeMenu():openMenu()});const dropdownItems=document.querySelectorAll('.nav-links .dropdown-item');function closeAllDropdowns(){dropdownItems.forEach(item=>{item.classList.remove('is-open');const link=item.querySelector('.nav-link');if(link)link.setAttribute('aria-expanded','false');})}
dropdownItems.forEach(item=>{const mainLink=item.querySelector('.nav-link');const submenu=item.querySelector('.submenu');const submenuLinks=submenu.querySelectorAll('a');if(!mainLink||!submenu||submenuLinks.length===0)return;const firstSubmenuLink=submenuLinks[0];const lastSubmenuLink=submenuLinks[submenuLinks.length-1];mainLink.addEventListener('keydown',(e)=>{const isDesktop=hamburgerBtn.offsetParent===null;if(isDesktop&&e.key==='ArrowDown'){e.preventDefault();closeAllDropdowns();item.classList.add('is-open');mainLink.setAttribute('aria-expanded','true');firstSubmenuLink.focus()}});submenu.addEventListener('keydown',(e)=>{const isDesktop=hamburgerBtn.offsetParent===null;if(!isDesktop)return;if(e.key==='Escape'){e.preventDefault();item.classList.remove('is-open');mainLink.setAttribute('aria-expanded','false');mainLink.focus()}
if(e.key==='Tab'&&!e.shiftKey&&document.activeElement===lastSubmenuLink){e.preventDefault();firstSubmenuLink.focus()}
if(e.key==='Tab'&&e.shiftKey&&document.activeElement===firstSubmenuLink){e.preventDefault();lastSubmenuLink.focus()}})});document.addEventListener('keydown',(e)=>{if(e.key==='Escape'){if(navLinksContainer.classList.contains('is-active')){e.preventDefault();closeMenu()}
const openDropdown=document.querySelector('.dropdown-item.is-open');if(openDropdown){e.preventDefault();const mainLink=openDropdown.querySelector('.nav-link');openDropdown.classList.remove('is-open');if(mainLink){mainLink.setAttribute('aria-expanded','false');mainLink.focus()}}}
if(navLinksContainer.classList.contains('is-active')){const isMobile=hamburgerBtn.offsetParent!==null;if(isMobile&&e.key==='Tab'){const focusableItemsMobile=navLinksContainer.querySelectorAll('a[href]:not([disabled]), button:not([disabled])');const firstFocusableItemMobile=focusableItemsMobile[0];const lastFocusableItemMobile=focusableItemsMobile[focusableItemsMobile.length-1];if(e.shiftKey){if(document.activeElement===firstFocusableItemMobile){e.preventDefault();lastFocusableItemMobile.focus()}}else{if(document.activeElement===lastFocusableItemMobile){e.preventDefault();firstFocusableItemMobile.focus()}}}}});document.addEventListener('click',(e)=>{if(!e.target.closest('.dropdown-item')){closeAllDropdowns()}
const isMobile=hamburgerBtn.offsetParent!==null;if(isMobile&&navLinksContainer.classList.contains('is-active')&&e.target.closest('#nav-links')&&e.target.tagName==='A'){closeMenu()}})})